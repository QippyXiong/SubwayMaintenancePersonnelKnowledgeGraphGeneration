# 基于LLM的动态数据处理

主要目的是通过LLM直接完成文本信息抽取的工作，在没有训练数据集的情况下依然能够构造一个知识图谱。

## Prompt Engineering基本概念

Prompt Engineering(提示工程)目的在于通过大语言模型的问答任务，设计适合的提问和对话，来保证LLM能够稳定生成符合预期目标的结果。

## gpt-3.5-turbo 上的 Prompt Engineering

目的是是通过设计合适的提问方式，保证 gpt-3.5 能够稳定生成文本信息抽取任务的目标格式。

### 基本prompt编写

一个prompt的格式可以按照如下方式进行编写：

在我们目前的任务中，一个基本Prompt的例子是：

---

你的任务是从地铁人员维修记录本文中提取出这个记录中包含的人物、他们的岗位、他们完成的维修内容、此次维修所在的地点、维修开始时间、维修结束时间、维修持续时间。

你需要将你的输出结果组织成一个json数组，数组中的一个元素的格式如下：
{
	"person": 维修人员名称,
	"station": 人员的岗位,
	"content": 完成的维修内容,
	"place": 维修所在地点,
	"begin_time": 维修开始时间,
	"end_time": 维修结束时间,
	"durationi": 维修持续时间
}
你应当将文本中未提及的字段标记为none

你需要处理的文本：

2023年7月28日，上午八点发现小寨站处铁轨损发生破损，同时造成了地铁车辆车轮损坏，铁轨维修人员蔡海波立刻前往进行维修，维修持续了三个小时，修复了铁轨的破损情况，使得地铁能够继续正常运行；同时车辆维修人员平如愿前往查看车辆情况，不仅维修了车轮，而且修复了地铁车厢的车窗问题，在下午两点钟完成了车辆的全部维修工作，两次任务中，维修人员熊深豪参与了辅助工作。

---

网页gpt(3.5)返回结果：

---

根据提供的文本，我将提取相关信息并组织成一个JSON数组，并将文本中未提及的字段标记为null：

```json
[
  {
    "person": "蔡海波",
    "station": "铁轨维修人员",
    "content": "修复了铁轨的破损情况",
    "place": "小寨站",
    "begin_time": "2023年7月28日 上午八点",
    "end_time": "2023年7月28日 上午十一点",
    "duration": "3小时"
  },
  {
    "person": "平如愿",
    "station": "车辆维修人员",
    "content": "维修了车轮，修复了地铁车厢的车窗问题",
    "place": null,
    "begin_time": "2023年7月28日 下午两点",
    "end_time": null,
    "duration": null
  },
  {
    "person": "熊深豪",
    "station": "维修助手",
    "content": "辅助工作",
    "place": null,
    "begin_time": null,
    "end_time": null,
    "duration": null
  }
]
```

文本中未提及的字段均被标记为null，如有需要，您可以提供更多信息以完善JSON数组中的数据。

---

API: gpt-3.5-turbo返回结果：

---

```json
[
  {
    "person": "蔡海波",
    "station": "铁轨维修人员",
    "content": "修复了铁轨的破损情况",
    "place": "小寨站",
    "begin_time": "2023年7月28日上午八点",
    "end_time": "2023年7月28日上午十一点",
    "duration": "3个小时"
  },
  {
    "person": "平如愿",
    "station": "车辆维修人员",
    "content": "维修了车轮，修复了地铁车厢的车窗问题",
    "place": null,
    "begin_time": null,
    "end_time": "2023年7月28日下午两点",
    "duration": null
  },
  {
    "person": "熊深豪",
    "station": "辅助工作人员",
    "content": null,
    "place": null,
    "begin_time": null,
    "end_time": null,
    "duration": null
  }
]
```

---

可以看到typo错误（durationi）被修复了，原因估计也是因为这个错误仅仅是多了一个字母。gpt基本上完成信息抽取的任务，返回一定结构化的数据，但这个一定结构化不代表其能直接放到数据库里了，比如content包含了两个以上的任务（在返回人物平如愿的例子中），以及两次返回的时间表示方式不一样。

目前的主要思路分为两条：
	1. 继续强化Prompt设计，来保证其输出的内容更加规范满足要求
	1. 返回数据后处理